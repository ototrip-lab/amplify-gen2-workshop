# アプリ作成

Kiro CLI を使用して Todo アプリを実装していきます。

## setup

### フレームワークの確認（準備済み）

本ワークショップで使用する初期設定がすでにセットアップされています。

<details>

```shell
# vite - react のセットアップ
npm create vite@latest todo-app -- --template react-ts

# amplify のセットアップ
npm create amplify@latest -- --template react-vite
```

</details>

以下を確認してください。

1. `todo-app` ディレクトリが存在する
2. `todo-app/amplify` ディレクトリが存在する

### 依存関係のインストール

アプリケーション作成に必要な JavaScript ライブラリをインストールします。

```shell
# 新しいターミナルを起動
cd /workspaces/sample/todo-app
npm install
```

### CDK Bootstrap

Amplify Gen2 は裏側で CDK を利用します。

CDK を初めて利用する AWS 環境・リージョンでは CDK Bootstrap という処理が必要です。

[CDK Bootstrap とは](https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/bootstrapping-env.html)

まだやっていない環境であれば、[マネコン](https://us-east-1.console.aws.amazon.com/amplify/create/bootstrap?region=us-east-1)にアクセスして Bootstrap を実行してください。

5 分程度かかりますので、お待ちください。

`CDKToolkit は us-east-1 リージョンですでに正常にセットアップされています。` と表示されていれば完了です。

### サーバーの起動

#### Amplify Sandbox

Amplify Sandbox サーバーを起動します。

```shell
cd /workspaces/sample/todo-app
npx ampx sandbox
```

Amplify Gen2 を開発するための Sandbox 環境が構築されます。

5 分程度かかりますので、お待ちください。

`File written: amplify_outputs.json` と表示されれば完了です。

#### Vite

次に、Vite 開発サーバーを起動します。

```shell
# 新しいターミナルを起動
cd /workspaces/sample/todo-app
npm run dev

➜  Local:   http://localhost:5173/
```

`ブラウザで開く` をクリックすると、別タブでアプリが表示されます。

別タブで `Vite + React` と記載されたページが表示されれば完了です。

このアプリを改良して Todo アプリにします。

## Kiro CLI によるコーディング支援

Kiro CLI を使用してアプリを作成していきます。

### ログイン画面

まず、ログイン画面を実装します。

```shell
kiro-cli
>
Amplify UI でログイン画面を作成してください。
最初に AWS MCP サーバーの Amplify ガイド付きワークフローを確認してください。
次に状況を確認して実装に移ってください。現在の状況は以下の通りです。

## プロジェクトセットアップ
* `npm create vite@latest todo-app -- --template react-ts`
* `npm create amplify@latest -- --template react-vite`

## 開発サーバー
* `npm run start` : Vite サーバーの起動
* `npx ampx sandbox` : Amplify Sandbox サーバーの起動

日本語で回答してください。
```

別タブで表示されているアプリにログイン画面が表示されれば完了です。
サインアップまで済ませておきましょう。

### Todo 機能

次に Todo 機能を追加します。

```shell
kiro-cli
>
Todo 機能を追加してください。

## 必要な機能
必要な機能は以下の通りです。

* ユーザーが自分の Todo を CRUD できる
* ユーザーが他の人の Todo を Read できる
* Todo には以下の項目が存在する
    * title: string
    * content: string
    * status: enum[pending, in_progress, completed]
    * category: string[]

## 実装手順
以下の順で実装してください

1. `amplify/` ディレクトリ以下を修正し、バックエンドを実装する
2. `src/` ディレクトリ以下を修正し、フロントエンドを実装する

日本語で回答してください。
```

Todo アプリが表示されれば完了です。
実際にアプリを使用して、動作に問題がないことを確認しましょう。

### デザイン修正

最後にデザインを整えてもらいます。

```shell
kiro-cli
>
Todo アプリのデザインを整えてください。
要望としては以下の通りです。

* <自由に変更してください> なテイストにする
* Amplify UI を使用する

日本語で回答してください。
```

最後に成果をコミットしておきましょう。

ここまで確認できたら、次のステップ（[docs/3\_ホスティング.md](3_ホスティング.md)）に進んでください。
