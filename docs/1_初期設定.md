# 初期設定

## 事前準備

### アカウント作成

本ワークショップは以下のアカウントが事前に作成されていることを前提としています。

- AWS アカウント（Admin 相当）
  - マネージメントコンソールにアクセスできるユーザーを用意してください。
  - MFA 必須のユーザーは利用できません。
- AWS Builder ID
  - [Profile ページ](https://profile.aws.amazon.com/)にログインしておいてください。
  - 作成手順は[公式情報](https://docs.aws.amazon.com/ja_jp/signin/latest/userguide/create-builder-id.html)を参照してください。
- GitHub アカウント
  - GitHub Codespaces を利用可能なアカウントを用意してください。
  - 作成手順は[公式情報](https://docs.github.com/ja/get-started/start-your-journey/creating-an-account-on-github)を参照してください。

アカウントがない場合は、作成してから続きを進めてください。

### 環境準備

本ワークショップは GitHub Codespaces 上で実行されることを想定しています。

別の環境を使用される場合は、適宜読み替えて進めてください。

## テンプレートのコピー

### リポジトリのテンプレート作成

本ワークショップのテンプレートリポジトリから、自分のアカウントに新しいリポジトリを作成します。

1. [ワークショップテンプレートリポジトリ](https://github.com/ototrip-lab/amplify-gen2-workshop)にアクセス
2. 右上の「Use this template」ボタンをクリック
3. 「Create a new repository」を選択
4. リポジトリ名を入力（例: `amplify-gen2-workshop`）
5. Private を選択
6. 「Create repository」をクリック

### Codespaces で開く

作成したリポジトリを GitHub Codespaces で開きます。

1. 作成したリポジトリのページで「Code」ボタンをクリック
2. 「Codespaces」タブを選択
3. 「Create codespace on main」をクリック

Codespaces が起動し、開発環境が自動的にセットアップされます。

> [!NOTE]
>
> ローカル環境で作業する場合は、以下のコマンドでクローンしてください。
>
> ```shell
> git clone https://github.com/[your-username]/[repository-name].git
> cd [repository-name]
> ```

## インストール

### 設定済み

AWS CLI と Node.js は Dev Containers によりインストール済みです。

[Dev Containers とは？](https://docs.github.com/ja/codespaces/setting-up-your-project-for-codespaces/adding-a-dev-container-configuration/introduction-to-dev-containers)

設定が完了しているか、以下のコマンドで確認してください。

```shell
aws --version
# aws-cli/2.32.21 Python/3.13.11 Linux/6.10.14-linuxkit exe/aarch64.debian.12

node -v
# v24.12.0
```

### Kiro CLI

本ワークショップでは、Kiro CLI を利用します。

```shell
curl -fsSL https://cli.kiro.dev/install | bash
```

`🎉 Installation complete! Happy coding!` と表示されれば完了です。

### UV

Kiro CLI から [AWS MCP サーバー](https://docs.aws.amazon.com/aws-mcp/latest/userguide/what-is-mcp-server.html)を利用します。

そのために、UV コマンドを利用可能にしておきます。

```shell
curl -LsSf https://astral.sh/uv/install.sh | sh
```

`everything's installed!` と表示されれば完了です。

## ログイン

### AWS CLI

`aws login` コマンドを利用します。
詳細な情報は[公式ドキュメント](https://docs.aws.amazon.com/ja_jp/signin/latest/userguide/command-line-sign-in.html#command-line-sign-in-local-development)をご覧ください。

まず、AWS マネジメントコンソールにサインインしてください。

> [!WARNING]
>
> `AmplifyBackendDeployFullAccess`権限ではエラーが発生する可能性があります。
>
> スムーズな進行のためには、Admin 相当権限でサインインすることをお勧めします。

リージョンをバージニア北部（us-east-1）に切り替えてください。

次に、CLI のログインを実行します。

```shell
aws login --remote
> AWS Region [us-east-1]: # そのまま Enter

# URL が表示されるのでクリックし、verification code を取得する
# verification code を CLI に入力し、認証を完了させる

# `Updated profile default to use arn:aws:iam::~ credentials.` と表示されれば完了です。

# ログイン完了を確認する
aws sts get-caller-identity
```

> [!WARNING]
>
> 本ワークショップにおいて、MFA 必須のアカウントでは `aws login` コマンドが利用できません。
>
> その場合は別の方法でクレデンシャルの設定を実施してください。

### Kiro CLI

Kiro CLI にログインします。

```shell
kiro-cli login --use-device-flow
❯ Use with Builder ID # Builder ID を選択する

# URL が表示されるのでクリックし、アクセスを許可する
```

`Logged in successfully` と表示されれば完了です。

## 初期設定完了の確認

```shell
kiro-cli
> Amplify 開発ではどのようなガイド付きワークフローが利用できますか?

# MCP サーバーを利用して、「Amplify 開発では、以下の 3 つの主要なガイド付きワークフローが利用できます」と回答されれば完了
```

ここまで確認できたら、次のステップ（[docs/2\_アプリ作成.md](2_アプリ作成.md)）に進んでください。
